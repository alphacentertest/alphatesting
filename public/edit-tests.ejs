<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8">
    <title>Редагувати тести</title>
    <style>
      body { font-size: 24px; margin: 20px; }
      input[type="text"], input[type="number"] { font-size: 24px; padding: 5px; margin: 5px; }
      button { font-size: 24px; padding: 10px 20px; margin: 5px; }
      .delete-btn { background-color: #ff4d4d; color: white; }
      .test-row { display: flex; align-items: center; margin-bottom: 10px; }
      .checkbox-label { margin-left: 10px; margin-right: 10px; }
    </style>
  </head>
  <body>
    <h1>Редагувати тести</h1>
    <form method="POST" action="/admin/edit-tests">
      <input type="hidden" name="csrfToken" value="<%= csrfToken %>">
      <% Object.entries(testNames).forEach(([num, data]) => { %>
        <div class="test-row">
          <label for="test<%= num %>">Назва Тесту <%= num %>:</label>
          <input type="text" id="test<%= num %>" name="test<%= num %>" value="<%= data.name %>" required>
          <label for="time<%= num %>">Час (сек):</label>
          <input type="number" id="time<%= num %>" name="time<%= num %>" value="<%= data.timeLimit %>" required min="1">
          <label class="checkbox-label" for="random<%= num %>">Випадковий вибір питань:</label>
          <input type="checkbox" id="random<%= num %>" name="random<%= num %>" <%= data.randomOrder ? 'checked' : '' %>>
          <label for="limit<%= num %>">Кількість питань:</label>
          <input type="number" id="limit<%= num %>" name="limit<%= num %>" value="<%= data.questionLimit || '' %>" min="1" placeholder="Усі">
          <button type="button" class="delete-btn" onclick="deleteTest('<%= num %>')">Видалити</button>
        </div>
      <% }) %>
      <button type="submit">Зберегти</button>
    </form>
    <button onclick="window.location.href='/admin'">Повернутися до адмін-панелі</button>
    <script>
      async function deleteTest(testNumber) {
        if (confirm('Ви впевнені, що хочете видалити Тест ' + testNumber + '?')) {
          await fetch('/admin/delete-test', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ testNumber, csrfToken: "<%= csrfToken %>" }),
            credentials: 'same-origin'
          });
          window.location.reload();
        }
      }
    </script>
  </body>
</html>
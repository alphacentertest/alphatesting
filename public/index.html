<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Авторизація</title>
    <style>
      body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
      .container { max-width: 400px; margin: 0 auto; }
      input[type="password"], button { padding: 10px; margin: 10px; width: 100%; }
      .show-password { margin-left: 10px; }
      .error { color: red; }
      .success { color: green; }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Введіть пароль</h1>
      <form id="loginForm" onsubmit="handleLogin(event)">
        <input type="password" name="password" id="password" placeholder="Пароль" required>
        <br>
        <input type="checkbox" id="showPassword" class="show-password">
        <label for="showPassword">Показати пароль</label>
        <br>
        <input type="checkbox" id="rememberMe" name="rememberMe">
        <label for="rememberMe">Запам’ятати мене</label>
        <br>
        <button type="submit">Ввести пароль</button>
      </form>
      <p id="message"></p>
    </div>
    <script>
      document.getElementById('showPassword').addEventListener('change', function() {
        const passwordInput = document.getElementById('password');
        passwordInput.type = this.checked ? 'text' : 'password';
      });

      async function handleLogin(event) {
        event.preventDefault();
        const form = document.getElementById('loginForm');
        const messageElement = document.getElementById('message');
        const password = document.getElementById('password').value;
        const rememberMe = document.getElementById('rememberMe').checked;

        try {
          const response = await fetch('/login', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: new URLSearchParams({
              password: password,
              rememberMe: rememberMe
            }).toString()
          });
          const data = await response.json();
          if (data.success) {
            messageElement.textContent = 'Успішний вхід!';
            messageElement.className = 'success';
            setTimeout(() => {
              window.location.href = data.redirect;
            }, 1000);
          } else {
            messageElement.textContent = data.message || 'Невірний пароль';
            messageElement.className = 'error';
          }
        } catch (error) {
          console.error('Login error:', error);
          messageElement.textContent = 'Помилка сервера';
          messageElement.className = 'error';
        }
      }
    </script>
  </body>
</html>
